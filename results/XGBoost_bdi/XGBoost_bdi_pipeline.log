2025-01-21 15:24:52,151 - INFO - Starting the XGBoost pipeline...
2025-01-21 15:24:52,151 - INFO - ----------------------------------
2025-01-21 15:24:52,151 - INFO - Parameters:
2025-01-21 15:24:52,152 - INFO - Data: /home/georg-tirpitz/Documents/PD-MultiModal-Prediction/data/bdi_df.csv
2025-01-21 15:24:52,152 - INFO - Target: BDI_diff
2025-01-21 15:24:52,152 - INFO - Features: []
2025-01-21 15:24:52,152 - INFO - Outlier removal: False
2025-01-21 15:24:52,152 - INFO - CV: 5
2025-01-21 15:24:52,152 - INFO - Correlation threshold: 0.9
2025-01-21 15:24:52,152 - INFO - Save results: True
2025-01-21 15:24:52,152 - INFO - Save path: /home/georg-tirpitz/Documents/PD-MultiModal-Prediction/results/XGBoost_bdi
2025-01-21 15:24:52,152 - INFO - Identifier: XGBoost_bdi
2025-01-21 15:24:52,152 - INFO - Random state: 42
2025-01-21 15:24:52,152 - INFO - ----------------------------------
2025-01-21 15:24:52,155 - INFO - Using all the features except BDI_diff
2025-01-21 15:24:52,155 - INFO - Features:
2025-01-21 15:24:52,171 - INFO -    TimeSinceSurgery  BDI_sum_pre  AGE_AT_OP  UPDRS3_ratio   theta_L   theta_R   alpha_L   alpha_R  ...  LEDD_ratio       X_L       Y_L       Z_L       X_R       Y_R       Z_R  Pat_ID
0          1.875535    -1.044626  -1.626743      0.228571  1.079076  2.185122 -0.663495 -0.846193  ...    0.483697  1.406372  1.123219  0.314063  0.303803 -0.097850  0.048973       0
1          1.591121    -0.339969  -0.688101      0.466667  0.668576 -1.325123 -0.750332 -0.393673  ...   -0.352508  0.372167  0.168877  0.184897 -0.136886 -0.008634  0.280166       1
2          1.914399    -0.339969  -0.688101      0.466667  0.668576 -1.325123 -0.750332 -0.393673  ...   -0.352508  0.372167  0.168877  0.184897 -0.136886 -0.008634  0.280166       2
3          1.534591    -0.339969   0.857974      0.594595 -0.664756  1.135554  1.871738  2.078292  ...   -1.515932  0.989448 -1.319024 -1.095072 -0.666488 -0.811844 -1.137888       3
4          1.691814    -0.574855  -0.379085      0.547170 -0.412726 -1.696008 -0.254224 -1.330550  ...    0.398371 -0.195285 -0.451085 -0.717200 -0.761043 -1.202338 -0.217758       4

[5 rows x 22 columns]
2025-01-21 15:24:52,186 - INFO - ----------------------------------
2025-01-21 15:24:52,186 - INFO - Target:
2025-01-21 15:24:52,187 - INFO - 0    -2.0
1    -3.0
2    -3.0
3   -18.0
4    -8.0
Name: BDI_diff, dtype: float64
2025-01-21 15:24:52,187 - INFO - ----------------------------------
2025-01-21 15:24:52,187 - INFO - Number of samples: 72
2025-01-21 15:24:52,187 - INFO - ----------------------------------
2025-01-21 15:24:52,801 - INFO - Preprocessed data saved as data/XGBoost_bdi_X.csv
2025-01-21 15:24:52,801 - INFO - Training the model...
2025-01-21 15:24:52,801 - INFO - ----------------------------------
2025-01-21 15:24:52,801 - INFO - Hyperparameter grid:
2025-01-21 15:24:52,801 - INFO - n_estimators: [150, 200, 500, 1000, 50]
2025-01-21 15:24:52,801 - INFO - learning_rate: [0.001, 0.01, 0.1, 0.2]
2025-01-21 15:24:52,801 - INFO - max_depth: [5, 6, 7, 8, 9, 10]
2025-01-21 15:24:52,801 - INFO - subsample: [0.6, 0.8, 1.0]
2025-01-21 15:24:52,801 - INFO - colsample_bytree: [0.6, 0.8, 1.0]
2025-01-21 15:24:52,801 - INFO - ----------------------------------
2025-01-21 15:24:52,802 - INFO - ----------------------------------
2025-01-21 15:24:52,802 - INFO - Training fold [1/5]:
2025-01-21 15:28:13,441 - INFO - Mean Squared Error: 60.621618923316916 for fold [1/5]
2025-01-21 15:28:13,441 - INFO - Best hyperparameters: {'colsample_bytree': 0.6, 'learning_rate': 0.1, 'max_depth': 5, 'n_estimators': 150, 'subsample': 0.6}
2025-01-21 15:28:13,441 - INFO - Estimating SHAP values...
2025-01-21 15:28:13,476 - INFO - SHAP values estimated for fold [1/5]
2025-01-21 15:28:13,477 - INFO - ----------------------------------
2025-01-21 15:28:13,477 - INFO - ----------------------------------
2025-01-21 15:28:13,477 - INFO - Training fold [2/5]:
2025-01-21 15:31:15,324 - INFO - Mean Squared Error: 30.57680687561699 for fold [2/5]
2025-01-21 15:31:15,324 - INFO - Best hyperparameters: {'colsample_bytree': 0.6, 'learning_rate': 0.2, 'max_depth': 6, 'n_estimators': 50, 'subsample': 0.6}
2025-01-21 15:31:15,324 - INFO - Estimating SHAP values...
2025-01-21 15:31:15,345 - INFO - SHAP values estimated for fold [2/5]
2025-01-21 15:31:15,345 - INFO - ----------------------------------
2025-01-21 15:31:15,345 - INFO - ----------------------------------
2025-01-21 15:31:15,345 - INFO - Training fold [3/5]:
2025-01-21 15:34:23,683 - INFO - Mean Squared Error: 44.14217289737483 for fold [3/5]
2025-01-21 15:34:23,683 - INFO - Best hyperparameters: {'colsample_bytree': 0.8, 'learning_rate': 0.1, 'max_depth': 5, 'n_estimators': 50, 'subsample': 0.6}
2025-01-21 15:34:23,683 - INFO - Estimating SHAP values...
2025-01-21 15:34:23,700 - INFO - SHAP values estimated for fold [3/5]
2025-01-21 15:34:23,700 - INFO - ----------------------------------
2025-01-21 15:34:23,700 - INFO - ----------------------------------
2025-01-21 15:34:23,700 - INFO - Training fold [4/5]:
2025-01-21 15:37:27,911 - INFO - Mean Squared Error: 86.87553203330626 for fold [4/5]
2025-01-21 15:37:27,911 - INFO - Best hyperparameters: {'colsample_bytree': 0.6, 'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 0.6}
2025-01-21 15:37:27,911 - INFO - Estimating SHAP values...
2025-01-21 15:37:28,110 - INFO - SHAP values estimated for fold [4/5]
2025-01-21 15:37:28,110 - INFO - ----------------------------------
2025-01-21 15:37:28,110 - INFO - ----------------------------------
2025-01-21 15:37:28,110 - INFO - Training fold [5/5]:
2025-01-21 15:40:42,660 - INFO - Mean Squared Error: 28.803856168609947 for fold [5/5]
2025-01-21 15:40:42,661 - INFO - Best hyperparameters: {'colsample_bytree': 1.0, 'learning_rate': 0.01, 'max_depth': 8, 'n_estimators': 150, 'subsample': 0.8}
2025-01-21 15:40:42,661 - INFO - Estimating SHAP values...
2025-01-21 15:40:42,704 - INFO - SHAP values estimated for fold [5/5]
2025-01-21 15:40:42,704 - INFO - ----------------------------------
2025-01-21 15:40:42,704 - INFO - All folds trained
2025-01-21 15:40:42,704 - INFO - Evaluating Model...
2025-01-21 15:40:42,706 - INFO - Pearson correlation: 0.24202748611593944, p-value: 0.04053159671001631
2025-01-21 15:40:42,706 - INFO - Nested CV Mean Squared Error: 50.20399737964499
2025-01-21 15:40:42,708 - INFO - Results saved as results/XGBoost_bdi_results.csv
2025-01-21 15:40:42,831 - INFO - Mean SHAP values saved as /home/georg-tirpitz/Documents/PD-MultiModal-Prediction/results/XGBoost_bdi/XGBoost_bdi_mean_shap_values.npy
