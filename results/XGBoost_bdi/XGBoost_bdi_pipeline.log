2025-02-06 22:57:13,133 - INFO - Starting the XGBoost pipeline...
2025-02-06 22:57:13,134 - INFO - ----------------------------------
2025-02-06 22:57:13,134 - INFO - Parameters:
2025-02-06 22:57:13,134 - INFO - Data: /home/georg/Documents/Neuromodulation/PD-MultiModal-Prediction/data/bdi_df.csv
2025-02-06 22:57:13,134 - INFO - Target: BDI_diff
2025-02-06 22:57:13,134 - INFO - Features: []
2025-02-06 22:57:13,134 - INFO - Outlier removal: False
2025-02-06 22:57:13,134 - INFO - CV: 5
2025-02-06 22:57:13,134 - INFO - Correlation threshold: 0.9
2025-02-06 22:57:13,134 - INFO - Save results: True
2025-02-06 22:57:13,134 - INFO - Save path: /home/georg/Documents/Neuromodulation/PD-MultiModal-Prediction/results/XGBoost_bdi
2025-02-06 22:57:13,134 - INFO - Identifier: XGBoost_bdi
2025-02-06 22:57:13,134 - INFO - Random state: 42
2025-02-06 22:57:13,134 - INFO - ----------------------------------
2025-02-06 22:57:13,138 - INFO - Using all the features except BDI_diff
2025-02-06 22:57:13,138 - INFO - Features:
2025-02-06 22:57:13,197 - INFO -    TimeSinceSurgery  BDI_sum_pre  AGE_AT_OP     MAD_L  ...       Z_R  UPDRS3_ratio  LEDD_ratio  Pat_ID
0          2.001890    -0.965171  -1.435615 -0.300096  ...  0.095169      0.228571    0.524138       0
1          1.721143    -0.054716  -0.470244  0.128623  ...  0.384569      0.466667   -0.260012       1
2          1.665342    -0.054716   1.119860 -0.395538  ... -1.390504      0.594595   -1.351010       3
3          1.820538    -0.358201  -0.152427  0.139420  ... -0.238716      0.547170    0.444124       4
4          1.445628     0.248770  -1.294931 -0.964478  ...  0.407480      0.916667    0.184688       5

[5 rows x 22 columns]
2025-02-06 22:57:13,206 - INFO - ----------------------------------
2025-02-06 22:57:13,206 - INFO - Target:
2025-02-06 22:57:13,206 - INFO - 0    -2.0
1    -3.0
2   -18.0
3    -8.0
4    -9.0
Name: BDI_diff, dtype: float64
2025-02-06 22:57:13,206 - INFO - ----------------------------------
2025-02-06 22:57:13,206 - INFO - Number of samples: 40
2025-02-06 22:57:13,206 - INFO - ----------------------------------
2025-02-06 22:57:13,524 - INFO - Preprocessed data saved as data/XGBoost_bdi_X.csv
2025-02-06 22:57:13,524 - INFO - Training the model...
2025-02-06 22:57:13,524 - INFO - ----------------------------------
2025-02-06 22:57:13,524 - INFO - Hyperparameter grid:
2025-02-06 22:57:13,524 - INFO - n_estimators: [150, 200, 500, 1000, 50]
2025-02-06 22:57:13,524 - INFO - learning_rate: [0.001, 0.01, 0.1, 0.2]
2025-02-06 22:57:13,524 - INFO - max_depth: [5, 6, 7, 8, 9, 10]
2025-02-06 22:57:13,524 - INFO - subsample: [0.6, 0.8, 1.0]
2025-02-06 22:57:13,524 - INFO - colsample_bytree: [0.6, 0.8, 1.0]
2025-02-06 22:57:13,524 - INFO - ----------------------------------
2025-02-06 22:57:13,524 - INFO - ----------------------------------
2025-02-06 22:57:13,525 - INFO - Training fold [1/5]:
2025-02-06 22:57:49,249 - INFO - Mean Squared Error: 21.313633084982477 for fold [1/5]
2025-02-06 22:57:49,249 - INFO - Best hyperparameters: {'colsample_bytree': 0.8, 'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 50, 'subsample': 0.6}
2025-02-06 22:57:49,249 - INFO - Estimating SHAP values...
2025-02-06 22:57:49,257 - INFO - SHAP values estimated for fold [1/5]
2025-02-06 22:57:49,258 - INFO - ----------------------------------
2025-02-06 22:57:49,258 - INFO - ----------------------------------
2025-02-06 22:57:49,258 - INFO - Training fold [2/5]:
2025-02-06 22:58:23,595 - INFO - Mean Squared Error: 64.48780975703534 for fold [2/5]
2025-02-06 22:58:23,596 - INFO - Best hyperparameters: {'colsample_bytree': 1.0, 'learning_rate': 0.001, 'max_depth': 6, 'n_estimators': 1000, 'subsample': 0.6}
2025-02-06 22:58:23,596 - INFO - Estimating SHAP values...
2025-02-06 22:58:23,668 - INFO - SHAP values estimated for fold [2/5]
2025-02-06 22:58:23,668 - INFO - ----------------------------------
2025-02-06 22:58:23,668 - INFO - ----------------------------------
2025-02-06 22:58:23,668 - INFO - Training fold [3/5]:
2025-02-06 22:58:58,107 - INFO - Mean Squared Error: 27.418324654915047 for fold [3/5]
2025-02-06 22:58:58,108 - INFO - Best hyperparameters: {'colsample_bytree': 0.6, 'learning_rate': 0.001, 'max_depth': 6, 'n_estimators': 50, 'subsample': 0.6}
2025-02-06 22:58:58,108 - INFO - Estimating SHAP values...
2025-02-06 22:58:58,119 - INFO - SHAP values estimated for fold [3/5]
2025-02-06 22:58:58,119 - INFO - ----------------------------------
2025-02-06 22:58:58,119 - INFO - ----------------------------------
2025-02-06 22:58:58,119 - INFO - Training fold [4/5]:
2025-02-06 22:59:32,209 - INFO - Mean Squared Error: 41.64790952737605 for fold [4/5]
2025-02-06 22:59:32,209 - INFO - Best hyperparameters: {'colsample_bytree': 0.6, 'learning_rate': 0.001, 'max_depth': 6, 'n_estimators': 50, 'subsample': 0.6}
2025-02-06 22:59:32,209 - INFO - Estimating SHAP values...
2025-02-06 22:59:32,217 - INFO - SHAP values estimated for fold [4/5]
2025-02-06 22:59:32,217 - INFO - ----------------------------------
2025-02-06 22:59:32,217 - INFO - ----------------------------------
2025-02-06 22:59:32,217 - INFO - Training fold [5/5]:
2025-02-06 23:00:06,473 - INFO - Mean Squared Error: 98.78836197732033 for fold [5/5]
2025-02-06 23:00:06,473 - INFO - Best hyperparameters: {'colsample_bytree': 1.0, 'learning_rate': 0.01, 'max_depth': 5, 'n_estimators': 50, 'subsample': 0.6}
2025-02-06 23:00:06,473 - INFO - Estimating SHAP values...
2025-02-06 23:00:06,486 - INFO - SHAP values estimated for fold [5/5]
2025-02-06 23:00:06,486 - INFO - ----------------------------------
2025-02-06 23:00:06,486 - INFO - All folds trained
2025-02-06 23:00:06,486 - INFO - Evaluating Model...
2025-02-06 23:00:06,487 - INFO - Pearson correlation: -0.06916655477714859, p-value: 0.6715039869263753
2025-02-06 23:00:06,487 - INFO - Nested CV Mean Squared Error: 50.73120780032585
2025-02-06 23:00:06,488 - INFO - Results saved as results/XGBoost_bdi_results.csv
2025-02-06 23:00:06,654 - INFO - Mean SHAP values saved as /home/georg/Documents/Neuromodulation/PD-MultiModal-Prediction/results/XGBoost_bdi/XGBoost_bdi_mean_shap_values.npy
